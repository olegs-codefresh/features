version: '1.0'
steps:
  
  build_step:
    title: building image
    type: build
    image_name: olegsucodefresh/features
  
  step_name:
    type: push
    title: Step Title
    candidate: ${{build_step}}
    tag: ${{CF_BRANCH}}
    image_name: olegsucodefresh/features
    registry: dockerhub
    
  deploy_to_k8:
    title: deploying to cluster
    type: deploy # new step type
    kind: kubernetes 
    cluster:  cf-load@codefresh-load # cluster name as it shown in integration page
    namespace: olsynt # desired namespace, default is 'default'
    service: test
#    candidate:
#      image: ${{build_step}}
#      registry: CFCR
    when:
      branch:
        only:
          - master
